- NR todo (Sept)
 - reports : now using new format for total style (using products table) some reports may have to be rewritten - to be investigated
 - menu re db : issue with sql patch 124 when upgrading from old release - to be looked at
 - menu :
 -- menu : make active tab work for ALL pages
 -- menu : fix colours for active tab drop down
 -- menu : if logged in change Login to Logout
 - patchesL 128 - 130 : if an if statement in them
 - reports need templates - so as to work with menu system
 - language : new language system - review
 - index.php review input if is safe enought
 - quick view : check all style if all cut size to 25 characters stuf fis working
 -- quick view : check consulting style - is descripton etc coming through OK?
 - lang: add new lang variables into all files : grep LANG_TODO

- NR done
 - menu : add + back into menu - done
 - print preview of Total style invocies needs to be fixed - done
 - menu : new read from db - what happens when user changes LANG - menu wont update - needs to be fixed - done
 - quick view - show customer fields for invoices in the invoice summary section and show by default - done
 - tax : nz - change to 12.5% - done
 - add biller: change 'street' to 'street address' - done
 - quick view - add file names extensions (xls,doc) back in to the export section - done
 - si_user and auth challenges table - add check to see if all ready exists(If not exists added to sql) - done
 - invoice save.php - needs to redirect to correct quick view invoice type - hard code type in url removed - relpaced with variable - done
 - menu : fix documentaion links about etc.. to be correct(you'll need to rerun this patch) - done
 - db connect: show nice messages again if cant connect (as in the previous release) - done
 - change System Defaults to System Preferences - done
 -- quick view : make export to pdf work - done
 - payments - make todays date appear as default in the date field - done
 - delete : delete invoice - make this happen - done
 - add more items : update ui - done
 -- add famfam icon for add button - done

- in next release +1 (NR1) - (aim end of Sept)
-todo
 - manage pages redevelopment!!
 - users/groups/domains - make this happen!
 - user admin ui
 - preferences: move rest into db
 - index.php : add filtering (php 5.2) for get and post input etc.
 - db: prevent sql injection (refer info point 1)
 - submit : update all refer to submit to better - only some done - all needs to be done and work
 - delete : if delete is enabled allow delete for ALL items - products, billers, etc.. all with their relevant rules ie. if product has been included in an invoice then CAN'T delete etc..
 - delete : wrap muliple delete ie for invoices in a sql transaction
 - reports : add export to .xls format NR+1
 - move the stuff in index and home in the LANG files
 - email :
 -- email : html and no html option - maybe??
 -- email: add cc - maybe ??
 -- email: add default signature - maybe - set in biller details ??
 -- email: and add validation
 - customer view - add edit/export etc, back in
 -- old ones
 - pdf: pdf of the default templated doesnt include some of the borders on the right sides - needs fixing
 - replce checkLogin with CheckBrowse - check login name assumes something to do with login when its not - not urgent
 - validation:
 -- Add validation to the edit screen - moved to next release - just validate on add for now
 -- make a proper validation function/class
 -- Product Add - add validation on price
 - choose automatic language (need to rename language files/subfolder). We should use this standards (first we can start with only 2 chars variant)
 -- http://www.rfc-editor.org/rfc/rfc4646.txt
 -- http://www.iana.org/assignments/language-subtag-registry
 --- sounds good - aim for NR+1
 - apply aplysia new drop down list code to others (refer system default: biller)

##############################

- Replace with easy function...
#get custom field labels
$customer_custom_field_label1 = get_custom_field_label("customer_cf1");
$customer_custom_field_label2 = get_custom_field_label("customer_cf2");
$customer_custom_field_label3 = get_custom_field_label("customer_cf3");
$customer_custom_field_label4 = get_custom_field_label("customer_cf4");

@ruflin (notes):
- make system defaults table nicer (name,value,id, ...)
- add due date for sending bills via e-mail (cron-script)
- make $tb_prefix a global constant to be accessible in all functions (without global)
- in pop-down menus the preselected entry is always twice. change it with the selected option
 -- i couldnt do this nicely :) if you could would be great
- use utf-8 for e-mail sending
- redesign of documentation (global and internal)
- custom-field redesign? more flexible?
- Search for invoice?
  - the goal of the new ajax grid is to have this via filters - refer link for example
  -- http://dowdybrown.com/dbprod/rico2/examples/php/ex3.php
  -- what do u think?
- invoices longer then 1 page? repeat header?
- logging all sql queries (what happened when, which user?) :
	function mysqlquerie($sql) {
		//insert $sql,timestamp,userid into database
		return mysql_querie($sql);
	} - done
-- this is a good idea - we should do - leave for next release or later
- thinking about user/groups. Extendebal system and connection with other database should be possible -> All throught 1 interface
- backup to a web directory is not really a good idea. Perhaps the download solution is a better one:
  -- just mod the existing backup script to dump to screen or download file - same as how phpmyadmin dumps to screeen - in a text box
  -- mod headers as in your example

<?php
include('config.php');

$conn = mysql_connect( $host, $user, $password );
mysql_select_db( $database, $conn );
$name = date("ymd")."_tillbackup.sql";
$backupFile = "/tmp/{$name}";

system("/sw/bin/mysqldump --user=$user --pass=$password $database > $backupFile");

header("Content-disposition: attachment; filename=$name");
header("Content-type: unknown/unknown");

include($backupFile);

unlink($backupFile);
?>

- Admin-Funtion: Cache Cleanup
- What happens if a page is longer then 1 page for printing? (header,footer?)

- Replace
if (!defined("BROWSE")) {
   echo "You Cannot Access This Script Directly, Have a Nice Day.";
   exit();
}
- with
checkLogin();

- Make custom_fields dynamic with the following tables

customFieldsCategorie
id,name (product,customer,biller,...)

customFields
id,categorieId,itemId,value

customFieldsValues
id,cateogireId,customFieldId,itemId,value

customFieldType (can be added as plugin or so...)
id, name, 


- Store Menu in the database...


- defining for every module an id?
- customFieldPlugin Id's have to be unique. 0 - 100 for shipping plugins. Other numbers can be choosen with attention (public list?)

###############
INFO SECTION
###############
1.
> Hey Jakob,
> 
> a few other people have mentioned SQL injection as an issue but i 
> havent really looked into it yet - i know i really need to :)
> 
> do you know of any example php code  etc.. or best practices re sql 
> injection? - it would be a great help cause i dont know much about it.

hi,
try to look into Drupal source for SQL functions. If you are GNU/GPL too, you can even adopt it :-)

The point is, that EVERY user inputted string must go through some escaping function:

<?php

$user = $_GET['user']; // $_POST['user'] // this is VERY vulnerable $result = MySQL_Query("SELECT * FROM users WHERE username = $user"); // this is NOT vulnerable $result = MySQL_Query("SELECT * FROM users WHERE username = '".mysql_real_escape_string($user)."'");

while ($row = MySQL_Fetch_Array($result)) {
  // this IS vulnerable to XSS
  print_r($row);
  // this IS NOT vulnerable to XSS
  htmlspecialchars(print_r($row));
}
?>

####################
DONE OLD STUFF
####################

 - sql patch: reset default invoices template to default - Done
 - sql patch: change custom fields to 255 lenght - up from the current 50 - Done
 - sql patch: change sql_patch field to 255 lenght - up from the current 50 - Done
 - fix the submenus - make placement work as normal - done
 - pdf: change the file name to a shorter one , invoice3.pdf instead of the current long one - done
 - sqlpatcehs - make sure this works - the latest patches dotn seem happy - done
 - css: make calendar popup css work as before - done
 - Replace $LANG strings with array - done
 - Start page in IE goign crazy again - check ie hacks file is loaded - done 
 - CSS - in reports page not working good - refer previous release for what its supposed to do
 -- lionel fixed
 - remove all reference to $wording_for_enabledFiedl and change to $LANG.enabled or $LANG.disabled - done
 - lang file cleanup up - done
 -- remove old $m- etc variables - done
 -- move the $lang_ to arrays ie $LANG['word'] - done 
 - validation:
 -- apply to all ADD sections of Simple Invoices - except new invoices -done
 - templates - add $smarty.post value to ALL values in add screen - done
 - Smarty: Customer - make details and save work - done
 - mysql db connect - if cant connect die and come up with sane error - done
 - sql patches error - if pathces unapplied show error and have a redirect link to the sqp patches page - done
 -- dont show the rest of the contents of start.php - done
 - invoice templates - move to smarty and cleanup - done
 - change index file that data update manager has to be run before working (done)
 - Manage sql patch - more to rico live grid - done
 - make email function work - done but needs polish
 -- add note on screen that the generation of pdf and email can take 30 seconds -dont do any more
 -- make the info pages for email funtion - done
 -- move email page to smarty - done
 - Add redirector after the sql patches have run - done
 - Quick View: make product custom fields work - done
 - Docs: change chmod 777 with chown apache:apache - done
 - sql queries: rename all the old crappy fields from b_name to name etc..
 -- need to write sql queries for all and change all relevant code that references these fields
 --- products, - done
 --- customers, - done
 --- billers, - done
 --- and invoices - done
 --- and invoices_items - done
 --- do the custom fields fields in biller etc.. to - needs to test the result - done
 - Defautls: on all screens that reference system defautls (ie biller etc..) make sure that the default item is working correctly - done
 - Edit biller etc. - Custom fields not shows - needs fix up - done
 - Tax rates - edit screen needs fix up - done
 - Enabled in edit page etc.. - check is working + check if working in all sections - done
 - Quick View: make invoice custom fields work - done
 - Customer: enabled drop down in edit not working correctly - done
 - alter sysdefaults table - done
 -- rename to system_defautls - done
 -- change invoice to preference - done
 -- change items to line_items - done
 - sql patches: make a conversion script for the old defaults to the new one - done
 - default template - remove logos - done
 - calculation on home.php not working - done
 - home.php - make the links to the documentation work - done
 - Fix reports to work with new db field names - done
 - add new lang for sys default saved - done
 - Move .sql out of install and back to root (untill the installer is done and included as default) - done
 - check all alert boxes work - done
 - update spanish file with tebas new file - done
 - lang files - make sure all have same variables - done
 - Help and About docs - add div id = left to left align them and test all work ok - done
 - include regexp stuff in docs.php file - done
 - Invoice templates 
 -- make merge_adress work in both templates - done
 -- make invoice items custom fields work - done
 -- make gross total work in both templates - done
 -- make product custom fields work - done - THANKS ruflin!!
 - update sql patch dates - done
 #post beta
 - manage payments - customer and biller name not showing - done
 - login.php change 
 - quick view mod re manage payments link
 - mysql 4 ? issue - my regex stuff needs mods - done

